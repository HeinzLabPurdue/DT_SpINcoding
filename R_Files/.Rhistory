# Onset rate
m_OR_d <- lmer(OnRate_d ~ HearingStatus*CF_kHz_log + (1|ChinID), data=data_an)
Anova(m_OR_d, test.statistic='F')
# Driven rate
m_DR_d <- lmer(SusRate_d ~ HearingStatus*CF_kHz_log + (1|ChinID), data=data_an)
Anova(m_DR_d, test.statistic='F')
# Onset rate
m_OR_g <- lm(OnRate_g_rel ~ HearingStatus*CF_kHz_log, data=data_g)
Anova(m_OR_g, test.statistic='F')
# Driven rate
m_DR_g <- lm(SusRate_g_rel ~ HearingStatus*CF_kHz_log, data=data_g)
Anova(m_DR_g, test.statistic='F')
## (/d/)
# Onset rate
m_OR_d <- lm(OnRate_d_rel ~ HearingStatus*CF_kHz_log, data=data_d)
Anova(m_OR_d, test.statistic='F')
# Driven rate
m_DR_d <- lm(SusRate_d_rel ~ HearingStatus*CF_kHz_log, data=data_d)
Anova(m_DR_d, test.statistic='F')
# Onset rate
m_OR_g <- lm(OnRate_g_rel ~ HearingStatus*CF_kHz_log, data=data_g)
Anova(m_OR_g, test.statistic='F')
# Driven rate
m_DR_g <- lm(SusRate_g_rel ~ HearingStatus*CF_kHz_log, data=data_g)
Anova(m_DR_g, test.statistic='F')
## (/d/)
# Onset rate
m_OR_d <- lm(OnRate_d_rel ~ HearingStatus*CF_kHz_log, data=data_d)
Anova(m_OR_d, test.statistic='F')
# Driven rate
m_DR_d <- lm(SusRate_d_rel ~ HearingStatus*CF_kHz_log, data=data_d)
Anova(m_DR_d, test.statistic='F')
rm(list = ls())
cat("\014")
restrict <- function(f,minVal,maxVal){
f <- f[f$CF_kHz >= minVal,]
f <- f[f$CF_kHz <= maxVal,]
return(f)
}
library(lme4)
library(car)
# Read data
data_an <- read.table("data_tables/Fig7_AN_plosive_all.txt", header = TRUE)
data_an$ChinID <- as.factor(data_an$ChinID)
data_an$HearingStatus<- as.factor(data_an$HearingStatus)
data_an$SRgroup <- as.factor(data_an$SpontRate > 18)
data_an$CF_kHz_log <- log(data_an$CF_kHz)
str(data_an)
data_g <- restrict(data_an, 0.5, 3)
data_d <- restrict(data_an, 0, 8)
print("Start: ------------- The effect of hearing loss")
### Without SpontRate
## (/g/)
# Onset rate
m_OR_g <- lm(OnRate_g ~ HearingStatus*CF_kHz_log, data=data_g)
Anova(m_OR_g, test.statistic='F')
# m_OR_g <- lmer(OnRate_g ~ HearingStatus*CF_kHz_log + (1|ChinID), data=data_g)
# Anova(m_OR_g, test.statistic='F')
# Driven rate
m_DR_g <- lm(SusRate_g ~ HearingStatus*CF_kHz_log, data=data_g)
Anova(m_DR_g, test.statistic='F')
# m_DR_g <- lmer(SusRate_g ~ HearingStatus*CF_kHz_log + (1|ChinID), data=data_g)
# Anova(m_DR_g, test.statistic='F')
## (/d/)
# Onset rate
m_OR_d <- lm(OnRate_d ~ HearingStatus*CF_kHz_log, data=data_d)
Anova(m_OR_d, test.statistic='F')
# m_OR_d <- lmer(OnRate_d ~ HearingStatus*CF_kHz_log + (1|ChinID), data=data_d)
# Anova(m_OR_d, test.statistic='F')
# Driven rate
m_DR_d <- lm(SusRate_d ~ HearingStatus*CF_kHz_log, data=data_d)
Anova(m_DR_d, test.statistic='F')
print("Start: ------------- The effect of hearing loss")
### Without SpontRate
## (/g/)
# Onset rate
m_OR_g <- lm(OnRate_g ~ HearingStatus*CF_kHz_log, data=data_g)
Anova(m_OR_g, test.statistic='F')
# m_OR_g <- lmer(OnRate_g ~ HearingStatus*CF_kHz_log + (1|ChinID), data=data_g)
# Anova(m_OR_g, test.statistic='F')
# Driven rate
m_DR_g <- lm(SusRate_g ~ HearingStatus*CF_kHz_log, data=data_g)
Anova(m_DR_g, test.statistic='F')
# m_DR_g <- lmer(SusRate_g ~ HearingStatus*CF_kHz_log + (1|ChinID), data=data_g)
# Anova(m_DR_g, test.statistic='F')
## (/d/)
# Onset rate
m_OR_d <- lm(OnRate_d ~ HearingStatus*CF_kHz_log, data=data_d)
Anova(m_OR_d, test.statistic='F')
# m_OR_d <- lmer(OnRate_d ~ HearingStatus*CF_kHz_log + (1|ChinID), data=data_d)
# Anova(m_OR_d, test.statistic='F')
# Driven rate
m_DR_d <- lm(SusRate_d ~ HearingStatus*CF_kHz_log, data=data_d)
Anova(m_DR_d, test.statistic='F')
print("Start: ------------- The effect of hearing loss")
### Without SpontRate
## (/g/)
# Onset rate
m_OR_g <- lm(OnRate_g ~ HearingStatus*CF_kHz_log, data=data_g)
Anova(m_OR_g, test.statistic='F')
# m_OR_g <- lmer(OnRate_g ~ HearingStatus*CF_kHz_log + (1|ChinID), data=data_g)
# Anova(m_OR_g, test.statistic='F')
# Driven rate
m_DR_g <- lm(SusRate_g ~ HearingStatus*CF_kHz_log, data=data_g)
Anova(m_DR_g, test.statistic='F')
data_g <- restrict(data_an, 0.5, 3)
data_d <- restrict(data_an, 0.5, 8)
print("Start: ------------- The effect of hearing loss")
### Without SpontRate
## (/g/)
# Onset rate
m_OR_g <- lm(OnRate_g ~ HearingStatus*CF_kHz_log, data=data_g)
Anova(m_OR_g, test.statistic='F')
# m_OR_g <- lmer(OnRate_g ~ HearingStatus*CF_kHz_log + (1|ChinID), data=data_g)
# Anova(m_OR_g, test.statistic='F')
# Driven rate
m_DR_g <- lm(SusRate_g ~ HearingStatus*CF_kHz_log, data=data_g)
Anova(m_DR_g, test.statistic='F')
# m_DR_g <- lmer(SusRate_g ~ HearingStatus*CF_kHz_log + (1|ChinID), data=data_g)
# Anova(m_DR_g, test.statistic='F')
## (/d/)
# Onset rate
m_OR_d <- lm(OnRate_d ~ HearingStatus*CF_kHz_log, data=data_d)
Anova(m_OR_d, test.statistic='F')
# m_OR_d <- lmer(OnRate_d ~ HearingStatus*CF_kHz_log + (1|ChinID), data=data_d)
# Anova(m_OR_d, test.statistic='F')
# Driven rate
m_DR_d <- lm(SusRate_d ~ HearingStatus*CF_kHz_log, data=data_d)
Anova(m_DR_d, test.statistic='F')
# m_DR_d <- lmer(SusRate_d ~ HearingStatus*CF_kHz_log + (1|ChinID), data=data_d)
# Anova(m_DR_d, test.statistic='F')
print("End: ------------- The effect of hearing loss")
data_g <- restrict(data_an, 0.5, 3)
data_d <- restrict(data_an, 0.5, 8)
print("Start: ------------- The effect of hearing loss")
### Without SpontRate
## (/g/)
# Onset rate
m_OR_g <- lm(OnRate_g ~ HearingStatus*CF_kHz_log, data=data_g)
Anova(m_OR_g, test.statistic='F')
# m_OR_g <- lmer(OnRate_g ~ HearingStatus*CF_kHz_log + (1|ChinID), data=data_g)
# Anova(m_OR_g, test.statistic='F')
# Driven rate
m_DR_g <- lm(SusRate_g ~ HearingStatus*CF_kHz_log, data=data_g)
Anova(m_DR_g, test.statistic='F')
# m_DR_g <- lmer(SusRate_g ~ HearingStatus*CF_kHz_log + (1|ChinID), data=data_g)
# Anova(m_DR_g, test.statistic='F')
## (/d/)
# Onset rate
m_OR_d <- lm(OnRate_d ~ HearingStatus*CF_kHz_log, data=data_d)
Anova(m_OR_d, test.statistic='F')
# m_OR_d <- lmer(OnRate_d ~ HearingStatus*CF_kHz_log + (1|ChinID), data=data_d)
# Anova(m_OR_d, test.statistic='F')
# Driven rate
m_DR_d <- lm(SusRate_d ~ HearingStatus*CF_kHz_log, data=data_d)
Anova(m_DR_d, test.statistic='F')
# m_DR_d <- lmer(SusRate_d ~ HearingStatus*CF_kHz_log + (1|ChinID), data=data_d)
# Anova(m_DR_d, test.statistic='F')
print("End: ------------- The effect of hearing loss")
rm(list = ls())
cat("\014")
restrict <- function(f,minVal,maxVal){
f <- f[f$CF_kHz >= minVal,]
f <- f[f$CF_kHz <= maxVal,]
return(f)
}
get_deq <- function(mdl){
var_out <- data.frame(d_eq_ttr=0, d_eq_q10=0, d_eq_thr=0)
depVars <- rownames(mdl)
ttr_ind <- match("TTR_dB", depVars)
Q10_ind <- match("Q10local", depVars)
thr_ind <- match("Threshold_dBSPL", depVars)
pVal_ttr= mdl$`Pr(>F)`[ttr_ind];
df_ttr= mdl$Df.res[ttr_ind];
var_out$d_eq_ttr = 2*qt(1 - pVal_ttr, df_ttr) / sqrt(df_ttr)
pVal_q10= mdl$`Pr(>F)`[Q10_ind];
df_q10= mdl$Df.res[Q10_ind];
var_out$d_eq_q10 = 2*qt(1 - pVal_q10, df_q10) / sqrt(df_q10)
pVal_thr= mdl$`Pr(>F)`[thr_ind];
df_thr= mdl$Df.res[thr_ind];
var_out$d_eq_thr = 2*qt(1 - pVal_thr, df_thr) / sqrt(df_thr)
return(var_out)
}
library(lme4)
library(car)
# Read data
data_all <- read.table("data_tables/Fig4_tbl_DT_CF2LF_withNan.txt", header = TRUE)
str(data_all)
data_all$ChinID <- as.factor(data_all$ChinID)
data_all$HearingStatus<- as.factor(data_all$HearingStatus)
data_all$SRgroup <- as.factor(data_all$SpontRate > 18)
data_all$CF_kHz_log <- log(data_all$CF_kHz)
data_lf <- restrict(data_all, 0, 3)
data_hf <- restrict(data_all, 3, 5.1)
## Driven rate
m_DR <- lm(DrivenRate ~ HearingStatus*CF_kHz_log + SpontRate, data=data_all)
Anova(m_DR, test.statistic='F')
m_DR <- lm(DrivenRate ~ HearingStatus*CF_kHz_log, data=data_all)
Anova(m_DR, test.statistic='F')
rm(list = ls())
cat("\014")
restrict <- function(f,minVal,maxVal){
f <- f[f$CF_kHz >= minVal,]
f <- f[f$CF_kHz <= maxVal,]
return(f)
}
get_deq <- function(mdl){
var_out <- data.frame(d_eq_ttr=0, d_eq_q10=0, d_eq_thr=0)
depVars <- rownames(mdl)
ttr_ind <- match("TTR_dB", depVars)
Q10_ind <- match("Q10local", depVars)
thr_ind <- match("Threshold_dBSPL", depVars)
pVal_ttr= mdl$`Pr(>F)`[ttr_ind];
df_ttr= mdl$Df.res[ttr_ind];
var_out$d_eq_ttr = 2*qt(1 - pVal_ttr, df_ttr) / sqrt(df_ttr)
pVal_q10= mdl$`Pr(>F)`[Q10_ind];
df_q10= mdl$Df.res[Q10_ind];
var_out$d_eq_q10 = 2*qt(1 - pVal_q10, df_q10) / sqrt(df_q10)
pVal_thr= mdl$`Pr(>F)`[thr_ind];
df_thr= mdl$Df.res[thr_ind];
var_out$d_eq_thr = 2*qt(1 - pVal_thr, df_thr) / sqrt(df_thr)
return(var_out)
}
library(lme4)
library(car)
# Read data
data_all <- read.table("data_tables/Fig4_tbl_DT_CF2LF_withNan.txt", header = TRUE)
str(data_all)
data_all$ChinID <- as.factor(data_all$ChinID)
data_all$HearingStatus<- as.factor(data_all$HearingStatus)
data_all$SRgroup <- as.factor(data_all$SpontRate > 18)
data_all$CF_kHz_log <- log(data_all$CF_kHz)
data_all<- restrict(data_all, 0, 5.1)
data_lf <- restrict(data_all, 0, 3)
data_hf <- restrict(data_all, 3, 5.1)
## Driven rate
m_DR <- lm(DrivenRate ~ HearingStatus*CF_kHz_log, data=data_all)
Anova(m_DR, test.statistic='F')
range(data_all$CF_kHz)
source('C:/Users/spsat/Dropbox/Articles/DT_SpIN_NHvHI/___files2share/R_Files/Fig1_abr_analysis.R', echo=TRUE)
source('C:/Users/spsat/Dropbox/Articles/DT_SpIN_NHvHI/___files2share/R_Files/Fig1_AN_analysis.R', echo=TRUE)
source('C:/Users/spsat/Dropbox/Articles/DT_SpIN_NHvHI/___files2share/R_Files/Fig1_dpoae_analysis.R', echo=TRUE)
source('C:/Users/spsat/Dropbox/Articles/DT_SpIN_NHvHI/___files2share/R_Files/FIg2_VP_anal_MulWndw.R', echo=TRUE)
source('C:/Users/spsat/Dropbox/Articles/DT_SpIN_NHvHI/___files2share/R_Files/Fig3_TTR_anal.R', echo=TRUE)
source('C:/Users/spsat/Dropbox/Articles/DT_SpIN_NHvHI/___files2share/R_Files/Fig4_dt_cf2lfpow_analysis.R', echo=TRUE)
source('C:/Users/spsat/Dropbox/Articles/DT_SpIN_NHvHI/___files2share/R_Files/Fig4_dt_cf2lfpow_analysis.R', echo=TRUE)
m_DR <- lm(DrivenRate ~ HearingStatus*CF_kHz_log, data=data_all)
Anova(m_DR, test.statistic='F')
m_SR <- lm(SpontRate ~ HearingStatus*CF_kHz_log, data=data_all)
Anova(m_SR, test.statistic='F')
m_CFpow <- lm(CFpow ~ HearingStatus*CF_kHz_log, data=data_all)
Anova(m_CFpow, test.statistic='F')
m_LFpow <- lm(LFpow ~ HearingStatus*CF_kHz_log, data=data_all)
Anova(m_LFpow, test.statistic='F')
m_dt1 <- lm(CF2LFpow ~ HearingStatus*CF_kHz_log, data=data_all)
Anova(m_dt1, test.statistic='F')
m_dt2 <- lmer(CF2LFpow ~ CF_kHz_log + Threshold_dBSPL + Q10local + TTR_dB + (1|ChinID), data=data_all)
stat_m_dt2 <- Anova(m_dt2, test.statistic='F')
print(stat_m_dt2)
var_out <- get_deq(stat_m_dt2)
print(var_out)
source('C:/Users/spsat/Dropbox/Articles/DT_SpIN_NHvHI/___files2share/R_Files/Fig5_SpIN_formant.R', echo=TRUE)
m_f1_hf <- lmer(F1pow  ~ CF_kHz_log + SNR + TTR_dB + Q10local + thresh_dB + (1|ChinID), data=dat_hf)
anOut_f1_hf <- Anova(m_f1_hf, test.statistic='F')
print(anOut_f1_hf)
var_out <- get_deq(anOut_f1_hf)
print(var_out)
dat_f2_cf <- restrict_cf(dat_all, 1, 2.5)
m_f2_cf <- lm(F2pow  ~ CF_kHz_log * SNR * HearingStatus, data=dat_f2_cf)
Anova(m_f2_cf, test.statistic='F')
m_f2_cf <- lmer(F2pow  ~ CF_kHz_log + SNR + TTR_dB + Q10local + thresh_dB + (1|ChinID), data=dat_f2_cf)
anOut_f2_cf <- Anova(m_f2_cf, test.statistic='F')
print(anOut_f2_cf)
var_out_f2_cf <- get_deq(anOut_f2_cf)
print(var_out_f2_cf)
dat_f3_cf <- restrict_cf(dat_all, 2, 3)
m_f3_cf <- lm(F3pow  ~ CF_kHz_log * SNR * HearingStatus, data=dat_f3_cf)
Anova(m_f3_cf, test.statistic='F')
m_f3_cf <- lmer(F3pow  ~ CF_kHz_log + SNR + TTR_dB + Q10local + thresh_dB + (1|ChinID), data=dat_f3_cf)
anOut_f3_cf <- Anova(m_f3_cf, test.statistic='F')
print(anOut_f3_cf)
var_out_f3_cf <- get_deq(anOut_f3_cf)
print(var_out_f3_cf)
dat_f3_cf <- restrict_cf(dat_all, 2, 3)
m_f3_cf <- lm(F3pow  ~ CF_kHz_log * SNR * HearingStatus, data=dat_f3_cf)
Anova(m_f3_cf, test.statistic='F')
m_f3_cf <- lmer(F3pow  ~ CF_kHz_log + SNR + TTR_dB + Q10local + thresh_dB + (1|ChinID), data=dat_f3_cf)
anOut_f3_cf <- Anova(m_f3_cf, test.statistic='F')
print(anOut_f3_cf)
var_out_f3_cf <- get_deq(anOut_f3_cf)
print(var_out_f3_cf)
source('C:/Users/spsat/Dropbox/Articles/DT_SpIN_NHvHI/___files2share/R_Files/Fig5_SpIN_formant.R', echo=TRUE)
rm(list = ls())
cat("\014")
restrict <- function(f,minVal,maxVal){
f <- f[f$CF_kHz >= minVal,]
f <- f[f$CF_kHz <= maxVal,]
return(f)
}
library(lme4)
library(car)
# Read FFR data
print("--------------------- Working on FFR")
data_ffr <- read.table("data_tables/Fig6_FFR_s_all.txt", header = TRUE)
data_ffr$HearingStatus <- as.factor(data_ffr$HearingStatus)
data_ffr$ChinID <- as.factor(data_ffr$ChinID)
str(data_ffr)
m_FFR <- lmer(OnRate ~ HearingStatus + (1|ChinID), data=data_ffr)
Anova(m_FFR, test.statistic='F')
# Read data
data_an <- read.table("data_tables/Fig6_AN_s_all.txt", header = TRUE)
str(data_an)
data_an$ChinID <- as.factor(data_an$ChinID)
data_an$HearingStatus<- as.factor(data_an$HearingStatus)
data_an$CF_kHz_log <- log(data_an$CF_kHz)
print("--------------------- Done with FFR")
print("--------------------- Working on AN data")
print("Start: ------------- The effect of hearing loss")
data_an_LF <- restrict(data_an, 0, 2.5)
data_an_HF <- restrict(data_an, 2.5, 8)
## Onset rate
m_OR <- lm(OnRate ~ HearingStatus*CF_kHz_log, data=data_an)
Anova(m_OR, test.statistic='F')
## Driven rate
m_DR <- lm(SusRate ~ HearingStatus*CF_kHz_log + SpontRate, data=data_an)
Anova(m_DR, test.statistic='F')
m_DR_LF <- lmer(SusRate ~ HearingStatus*CF_kHz_log + SpontRate + (1|ChinID), data=data_an_LF)
m_DR_HF <- lm(SusRate ~ HearingStatus*CF_kHz_log, data=data_an_HF)
Anova(m_DR_HF, test.statistic='F')
m_OR_HF <- lmer(OnRate ~ HearingStatus*CF_kHz_log + (1|ChinID), data=data_an_HF)
Anova(m_OR_HF, test.statistic='F')
source('C:/Users/spsat/Dropbox/Articles/DT_SpIN_NHvHI/___files2share/R_Files/Fig6_s_coding.R', echo=TRUE)
source('C:/Users/spsat/Dropbox/Articles/DT_SpIN_NHvHI/___files2share/R_Files/Fig6_s_coding.R', echo=TRUE)
m_DR_HF <- lm(SusRate ~ HearingStatus*CF_kHz_log, data=data_an_HF)
Anova(m_DR_HF, test.statistic='F')
m_DR_HF <- lm(SusRate ~ HearingStatus*CF_kHz_log, data=data_an_HF)
Anova(m_DR_HF, test.statistic='F')
m_OR_HF <- lmer(OnRate ~ HearingStatus*CF_kHz_log + (1|ChinID), data=data_an_HF)
Anova(m_OR_HF, test.statistic='F')
m_OR <- lm(OnRate ~ HearingStatus*CF_kHz_log, data=data_an)
Anova(m_OR, test.statistic='F')
m_DR_HF <- lm(SusRate ~ HearingStatus*CF_kHz_log, data=data_an_HF)
Anova(m_DR_HF, test.statistic='F')
m_OR_HF <- lmer(OnRate ~ HearingStatus*CF_kHz_log + (1|ChinID), data=data_an_HF)
Anova(m_OR_HF, test.statistic='F')
m_FFR <- lmer(OnRate ~ HearingStatus + (1|ChinID), data=data_ffr)
Anova(m_FFR, test.statistic='F')
m_OR <- lm(OnRate_rel ~ HearingStatus*CF_kHz_log, data=data_an_HF)
Anova(m_OR, test.statistic='F')
## Driven rate
m_DR <- lm(SusRate_rel ~ HearingStatus*CF_kHz_log, data=data_an_HF)
Anova(m_DR, test.statistic='F')
source('C:/Users/spsat/Dropbox/Articles/DT_SpIN_NHvHI/___files2share/R_Files/Fig7_plosve_anl.R', echo=TRUE)
m_OR_g <- lm(OnRate_g_rel ~ HearingStatus*CF_kHz_log, data=data_g)
Anova(m_OR_g, test.statistic='F')
<- read.table("data_tables/Fig7_FFR_plosive_all.txt", header = TRUE)
data_ffr$HearingStatus <- as.factor(data_ffr$HearingStatus)
data_ffr$ChinID <- as.factor(data_ffr$ChinID)
str(data_ffr)
m_FFR_d <- lmer(OnRate_d ~ HearingStatus + (1|ChinID), data=data_ffr)
Anova(m_FFR_d, test.statistic='F')
m_FFR_g <- lmer(OnRate_g ~ HearingStatus + (1|ChinID), data=data_ffr)
Anova(m_FFR_g, test.statistic='F')
rm(list = ls())
cat("\014")
get_deq <- function(mdl){
var_out <- data.frame(d_eq_ttr=0, d_eq_q10=0, d_eq_thr=0)
depVars <- rownames(mdl)
ttr_ind <- match("TTR_dB", depVars)
Q10_ind <- match("Q10local", depVars)
thr_ind <- match("Threshold_dBSPL", depVars)
pVal_ttr= mdl$`Pr(>F)`[ttr_ind];
df_ttr= mdl$Df.res[ttr_ind];
var_out$d_eq_ttr = 2*qt(1 - pVal_ttr, df_ttr) / sqrt(df_ttr)
pVal_q10= mdl$`Pr(>F)`[Q10_ind];
df_q10= mdl$Df.res[Q10_ind];
var_out$d_eq_q10 = 2*qt(1 - pVal_q10, df_q10) / sqrt(df_q10)
pVal_thr= mdl$`Pr(>F)`[thr_ind];
df_thr= mdl$Df.res[thr_ind];
var_out$d_eq_thr = 2*qt(1 - pVal_thr, df_thr) / sqrt(df_thr)
return(var_out)
}
library(lme4)
library(car)
dat <- read.table('table_fric_in_noise_withNan.txt', header=TRUE)
str(dat)
dat$ChinID <- as.factor(dat$ChinID) # Value doesn't matter
dat$UnitID <- as.factor(dat$UnitID) # Value doesn't matter
dat$RespCorrTXF <- log(atanh(abs(dat$RespCorr)))
dat$RespCorr_RawTXF <- log(1+atanh(.99*(dat$RespCorrRaw-min(dat$RespCorrRaw))/(max(dat$RespCorrRaw)-min(dat$RespCorrRaw)) ))
# dat$RespCorr_RawTXF <- atanh(dat$RespCorr)
# dat$RespCorr_RawTXF <- log(atanh(abs(dat$RespCorrRaw)))
dat$HearingStatus<- as.factor(dat$HearingStatus)
dat$SRgroup <- as.factor(dat$SpontRate > 18)
dat$StimSNR <- as.ordered(dat$StimSNR) # Value matters
dat$CF_kHz_log <- log(dat$CF_kHz)
dat$SignifCoding <- as.factor(dat$RespCorrRaw > .001)
####### Start with raw and check floor at the end
# Model #1
m4 <- lmer(RespCorrRaw  ~ CF_kHz_log + StimSNR + SRgroup*HearingStatus + (1|ChinID), data=dat)
Anova(m4, test.statistic='F')
plot(m4)
## Final
print("Final")
m4 <- lm(RespCorr  ~ CF_kHz_log + StimSNR + SRgroup*HearingStatus, data=dat)
Anova(m4, test.statistic='F')
rm(list = ls())
cat("\014")
get_deq <- function(mdl){
var_out <- data.frame(d_eq_ttr=0, d_eq_q10=0, d_eq_thr=0)
depVars <- rownames(mdl)
ttr_ind <- match("TTR_dB", depVars)
Q10_ind <- match("Q10local", depVars)
thr_ind <- match("Threshold_dBSPL", depVars)
pVal_ttr= mdl$`Pr(>F)`[ttr_ind];
df_ttr= mdl$Df.res[ttr_ind];
var_out$d_eq_ttr = 2*qt(1 - pVal_ttr, df_ttr) / sqrt(df_ttr)
pVal_q10= mdl$`Pr(>F)`[Q10_ind];
df_q10= mdl$Df.res[Q10_ind];
var_out$d_eq_q10 = 2*qt(1 - pVal_q10, df_q10) / sqrt(df_q10)
pVal_thr= mdl$`Pr(>F)`[thr_ind];
df_thr= mdl$Df.res[thr_ind];
var_out$d_eq_thr = 2*qt(1 - pVal_thr, df_thr) / sqrt(df_thr)
return(var_out)
}
library(lme4)
library(car)
dat <- read.table('table_fric_in_noise_withNan.txt', header=TRUE)
str(dat)
dat$ChinID <- as.factor(dat$ChinID) # Value doesn't matter
dat$UnitID <- as.factor(dat$UnitID) # Value doesn't matter
dat$RespCorrTXF <- log(atanh(abs(dat$RespCorr)))
dat$RespCorr_RawTXF <- log(1+atanh(.99*(dat$RespCorrRaw-min(dat$RespCorrRaw))/(max(dat$RespCorrRaw)-min(dat$RespCorrRaw)) ))
# dat$RespCorr_RawTXF <- atanh(dat$RespCorr)
# dat$RespCorr_RawTXF <- log(atanh(abs(dat$RespCorrRaw)))
dat$HearingStatus<- as.factor(dat$HearingStatus)
dat$SRgroup <- as.factor(dat$SpontRate > 18)
dat$StimSNR <- as.ordered(dat$StimSNR) # Value matters
dat$CF_kHz_log <- log(dat$CF_kHz)
dat$SignifCoding <- as.factor(dat$RespCorrRaw > .001)
####### Start with raw and check floor at the end
# Model #1
m4 <- lmer(RespCorrRaw  ~ CF_kHz_log + StimSNR + SRgroup*HearingStatus + (1|ChinID), data=dat)
Anova(m4, test.statistic='F')
plot(m4)
m4 <- lm(RespCorr  ~ CF_kHz_log + StimSNR + SRgroup*HearingStatus, data=dat)
Anova(m4, test.statistic='F')
m1_fricIN <- lmer(RespCorrRaw ~ CF_kHz_log + StimSNR + SRgroup + Threshold_dBSPL + Q10local + TTR_dB + (1|ChinID), data=dat)
Anova(m1_fricIN, test.statistic='F')
plot(m1_fricIN)
m4 <- lm(RespCorrRaw  ~ CF_kHz_log + StimSNR + SRgroup*HearingStatus, data=dat)
Anova(m4, test.statistic='F')
print("Final")
m4 <- lm(RespCorrRaw  ~ CF_kHz_log + StimSNR + SRgroup*HearingStatus, data=dat)
Anova(m4, test.statistic='F')
print("Final")
m4 <- lm(RespCorrRaw  ~ CF_kHz_log + StimSNR + SRgroup*HearingStatus, data=dat)
Anova(m4, test.statistic='F')
rm(list = ls())
cat("\014")
get_deq <- function(mdl){
var_out <- data.frame(d_eq_ttr=0, d_eq_q10=0, d_eq_thr=0)
depVars <- rownames(mdl)
ttr_ind <- match("TTR_dB", depVars)
Q10_ind <- match("Q10local", depVars)
thr_ind <- match("Threshold_dBSPL", depVars)
pVal_ttr= mdl$`Pr(>F)`[ttr_ind];
df_ttr= mdl$Df.res[ttr_ind];
var_out$d_eq_ttr = 2*qt(1 - pVal_ttr, df_ttr) / sqrt(df_ttr)
pVal_q10= mdl$`Pr(>F)`[Q10_ind];
df_q10= mdl$Df.res[Q10_ind];
var_out$d_eq_q10 = 2*qt(1 - pVal_q10, df_q10) / sqrt(df_q10)
pVal_thr= mdl$`Pr(>F)`[thr_ind];
df_thr= mdl$Df.res[thr_ind];
var_out$d_eq_thr = 2*qt(1 - pVal_thr, df_thr) / sqrt(df_thr)
return(var_out)
}
library(lme4)
library(car)
dat <- read.table('table_fric_in_noise_withNan.txt', header=TRUE)
str(dat)
dat$ChinID <- as.factor(dat$ChinID) # Value doesn't matter
dat$UnitID <- as.factor(dat$UnitID) # Value doesn't matter
dat$RespCorrTXF <- log(atanh(abs(dat$RespCorr)))
dat$RespCorr_RawTXF <- log(1+atanh(.99*(dat$RespCorrRaw-min(dat$RespCorrRaw))/(max(dat$RespCorrRaw)-min(dat$RespCorrRaw)) ))
# dat$RespCorr_RawTXF <- atanh(dat$RespCorr)
# dat$RespCorr_RawTXF <- log(atanh(abs(dat$RespCorrRaw)))
dat$HearingStatus<- as.factor(dat$HearingStatus)
dat$SRgroup <- as.factor(dat$SpontRate > 18)
dat$StimSNR <- as.ordered(dat$StimSNR) # Value matters
dat$CF_kHz_log <- log(dat$CF_kHz)
dat$SignifCoding <- as.factor(dat$RespCorrRaw > .001)
####### Start with raw and check floor at the end
# Model #1
m4 <- lmer(RespCorrRaw  ~ CF_kHz_log + StimSNR + SRgroup*HearingStatus + (1|ChinID), data=dat)
Anova(m4, test.statistic='F')
plot(m4)
## Final
print("Final")
m4 <- lm(RespCorrRaw  ~ CF_kHz_log + StimSNR + SRgroup*HearingStatus, data=dat)
Anova(m4, test.statistic='F')
graphics.off()
## Final
print("Final")
m4 <- lm(RespCorrRaw  ~ CF_kHz_log + StimSNR + SRgroup*HearingStatus, data=dat)
Anova(m4, test.statistic='F')
m1_fricIN <- lmer(RespCorrRaw ~ CF_kHz_log + StimSNR + Threshold_dBSPL + Q10local + TTR_dB + (1|ChinID), data=dat)
anOut_f1_hf <- Anova(m1_fricIN, test.statistic='F')
print(anOut_f1_hf)
var_out <- get_deq(anOut_f1_hf)
print(var_out)
source('C:/Users/spsat/Dropbox/Articles/DT_SpIN_NHvHI/___files2share/R_Files/Fig8_FricInNoise_analysis.R', echo=TRUE)
