setwd("C:\Users\spsat\Dropbox\Articles\DT_SpIN_NHvHI\matlab\tables_for_stats\RcloudFIles")
setwd('C:\Users\spsat\Dropbox\Articles\DT_SpIN_NHvHI\matlab\tables_for_stats\RcloudFIles'"')
setwd('C:\Users\spsat\Dropbox\Articles\DT_SpIN_NHvHI\matlab\tables_for_stats\RcloudFIles')
source('C:/Users/spsat/Dropbox/Articles/SpeechEnvCoding_NHvHI/matlab/Rfiles/Fig2_corr_analysis_NHvHI.R', echo=TRUE)
library(lme4)
library(car)
dat <- read.table('../tables_for_stats/Fig8_table_fric_in_noise_DR.txt', header=TRUE)
str(dat)
setwd("C:/Users/spsat/Dropbox/Articles/DT_SpIN_NHvHI/___files2share/RFiles/")
library(lme4)
library(car)
dat <- read.table('../tables_for_stats/Fig8_table_fric_in_noise_DR.txt', header=TRUE)
str(dat)
dat_all$StimSNR <- as.ordered(dat_all$StimSNR)
dat_all$HearingStatus<- as.factor(dat_all$HearingStatus)
str(dat)
View(dat)
dat_all <- read.table('../tables_for_stats/Fig8_table_fric_in_noise_DR.txt', header=TRUE)
dat_all$StimSNR <- as.ordered(dat_all$StimSNR)
dat_all$HearingStatus<- as.factor(dat_all$HearingStatus)
str(dat_all)
source('C:/Users/spsat/Dropbox/Articles/DT_SpIN_NHvHI/___files2share/RFiles/FigS3_FricInNoise_DR_ana.R', echo=TRUE)
source('C:/Users/spsat/Dropbox/Articles/DT_SpIN_NHvHI/___files2share/RFiles/FigS3_FricInNoise_DR_ana.R', echo=TRUE)
source('C:/Users/spsat/Dropbox/Articles/DT_SpIN_NHvHI/___files2share/RFiles/FigS3_FricInNoise_DR_ana.R', echo=TRUE)
source('C:/Users/spsat/Dropbox/Articles/DT_SpIN_NHvHI/___files2share/RFiles/FigS3_FricInNoise_DR_ana.R', echo=TRUE)
rm(list = ls())
cat("\014")
restrict_cf <- function(f,minVal,maxVal){
f <- f[f$CF_kHz >= minVal,]
f <- f[f$CF_kHz <= maxVal,]
return(f)
}
library(lme4)
library(car)
dat_all <- read.table('../tables_for_stats/Fig8_table_fric_in_noise_DR.txt', header=TRUE)
dat_all$StimSNR <- as.ordered(dat_all$StimSNR)
dat_all$HearingStatus<- as.factor(dat_all$HearingStatus)
dat_all$CF_kHz_log <- log(dat_all$CF_kHz)
str(dat_all)
dat_hf <- restrict_cf(dat_all, .5, 8â—˜)
m_sn <- lm(DR_SN  ~ CF_kHz_log * HearingStatus + StimSNR * HearingStatus, data=dat_hf)
Anova(m_sn, test.statistic='F')
m_n <- lm(DR_N  ~ CF_kHz_log * HearingStatus + StimSNR * HearingStatus, data=dat_hf)
Anova(m_n, test.statistic='F')
source('C:/Users/spsat/Dropbox/Articles/DT_SpIN_NHvHI/___files2share/RFiles/FigS3_FricInNoise_DR_ana.R', echo=TRUE)
str(dat_all)
dat$SRgroup <- as.factor(dat$SpontRate > 18)
View(dat_all)
dat_all$SRgroup <- as.factor(dat_all$SpontRate > 18)
m_n <- lm(DR_N  ~ CF_kHz_log * HearingStatus + SRgroup * StimSNR * HearingStatus, data=dat_hf)
m_n <- lm(DR_N  ~ CF_kHz_log * HearingStatus + SRgroup * StimSNR * HearingStatus, data=dat_hf)
Anova(m_n, test.statistic='F')
m_n <- lm(DR_N  ~ CF_kHz_log * HearingStatus + SRgroup * StimSNR * HearingStatus, data=dat_hf)
Anova(m_n, test.statistic='F')
source('C:/Users/spsat/Dropbox/Articles/DT_SpIN_NHvHI/___files2share/RFiles/FigS3_FricInNoise_DR_ana.R', echo=TRUE)
dat_hf <- restrict_cf(dat_all, 2.5, 8)
m_sn <- lm(DR_SN  ~ CF_kHz_log * HearingStatus + StimSNR * HearingStatus, data=dat_hf)
Anova(m_sn, test.statistic='F')
m_n <- lm(DR_N  ~ CF_kHz_log * HearingStatus + SRgroup * StimSNR * HearingStatus, data=dat_hf)
Anova(m_n, test.statistic='F')
inf
Inf
dat_lsr <- restrict_sr(dat_all, 0, 18)
dat_hsr <- restrict_sr(dat_all, 18, Inf)
source('C:/Users/spsat/Dropbox/Articles/DT_SpIN_NHvHI/___files2share/RFiles/FigS3_FricInNoise_DR_ana.R', echo=TRUE)
source('C:/Users/spsat/Dropbox/Articles/DT_SpIN_NHvHI/___files2share/RFiles/FigS3_FricInNoise_DR_ana.R', echo=TRUE)
m_sn_all <- lm(DR_SN  ~ CF_kHz_log * HearingStatus + SRgroup * StimSNR * HearingStatus, data=dat_hf)
Anova(m_sn_all, test.statistic='F')
m_sn_lsr <- lm(DR_SN  ~ CF_kHz_log * HearingStatus + SRgroup * StimSNR * HearingStatus, data=dat_lsr)
Anova(m_sn_all, test.statistic='F')
m_sn_hsr <- lm(DR_SN  ~ CF_kHz_log * HearingStatus + SRgroup * StimSNR * HearingStatus, data=dat_hsr)
Anova(m_sn_all, test.statistic='F')
source('C:/Users/spsat/Dropbox/Articles/DT_SpIN_NHvHI/___files2share/RFiles/FigS3_FricInNoise_DR_ana.R', echo=TRUE)
m_sn_all <- lm(DR_SN  ~ CF_kHz_log * HearingStatus + SRgroup * StimSNR * HearingStatus, data=dat_hf)
Anova(m_sn_all, test.statistic='F')
m_sn_lsr <- lm(DR_SN  ~ CF_kHz_log * HearingStatus + StimSNR * HearingStatus, data=dat_lsr)
Anova(m_sn_all, test.statistic='F')
m_sn_hsr <- lm(DR_SN  ~ CF_kHz_log * HearingStatus + StimSNR * HearingStatus, data=dat_hsr)
Anova(m_sn_all, test.statistic='F')
m_sn_all <- lm(DR_SN  ~ CF_kHz_log * HearingStatus + SRgroup * StimSNR * HearingStatus, data=dat_hf)
Anova(m_sn_all, test.statistic='F')
m_sn_lsr <- lm(DR_SN  ~ CF_kHz_log * HearingStatus + StimSNR * HearingStatus, data=dat_lsr)
Anova(m_sn_lsr, test.statistic='F')
m_sn_hsr <- lm(DR_SN  ~ CF_kHz_log * HearingStatus + StimSNR * HearingStatus, data=dat_hsr)
Anova(m_sn_hsr, test.statistic='F')
m_sn_hsr <- lm(DR_SN  ~ CF_kHz_log * HearingStatus + StimSNR * HearingStatus, data=dat_hsr)
Anova(m_sn_hsr, test.statistic='F')
m_sn_hsr <- lm(DR_SN  ~ CF_kHz_log * HearingStatus + StimSNR * HearingStatus, data=dat_hsr)
dat_hsr <- restrict_sr(dat_all, 18, 1000)
m_sn_hsr <- lm(DR_SN  ~ CF_kHz_log * HearingStatus + StimSNR * HearingStatus, data=dat_hsr)
Anova(m_sn_hsr, test.statistic='F')
m_sn_hsr <- lm(DR_SN  ~ CF_kHz_log * HearingStatus + StimSNR * HearingStatus, data=dat_hsr)
source('C:/Users/spsat/Dropbox/Articles/DT_SpIN_NHvHI/___files2share/RFiles/FigS3_FricInNoise_DR_ana.R', echo=TRUE)
m_sn_all <- lm(DR_SN  ~ CF_kHz_log * HearingStatus + SRgroup * StimSNR * HearingStatus, data=dat_hf)
Anova(m_sn_all, test.statistic='F')
m_sn_lsr <- lm(DR_SN  ~ CF_kHz_log * HearingStatus + StimSNR * HearingStatus, data=dat_lsr)
Anova(m_sn_lsr, test.statistic='F')
m_sn_hsr <- lm(DR_SN  ~ CF_kHz_log * HearingStatus + StimSNR * HearingStatus, data=dat_hsr)
Anova(m_sn_hsr, test.statistic='F')
m_n_all <- lm(DR_n  ~ CF_kHz_log * HearingStatus + SRgroup * StimSNR * HearingStatus, data=dat_hf)
Anova(m_n_all, test.statistic='F')
m_n_lsr <- lm(DR_SN  ~ CF_kHz_log * HearingStatus + StimSNR * HearingStatus, data=dat_lsr)
Anova(m_n_lsr, test.statistic='F')
m_sn_hsr <- lm(DR_SN  ~ CF_kHz_log * HearingStatus + StimSNR * HearingStatus, data=dat_hsr)
Anova(m_sn_hsr, test.statistic='F')
m_n_all <- lm(DR_n  ~ CF_kHz_log * HearingStatus + SRgroup * StimSNR * HearingStatus, data=dat_hf)
Anova(m_n_all, test.statistic='F')
m_n_lsr <- lm(DR_N  ~ CF_kHz_log * HearingStatus + StimSNR * HearingStatus, data=dat_lsr)
Anova(m_n_lsr, test.statistic='F')
m_sn_hsr <- lm(DR_N  ~ CF_kHz_log * HearingStatus + StimSNR * HearingStatus, data=dat_hsr)
Anova(m_sn_hsr, test.statistic='F')
m_sn_all <- lm(DR_SN  ~ CF_kHz_log * HearingStatus + SRgroup * StimSNR * HearingStatus, data=dat_hf)
Anova(m_sn_all, test.statistic='F')
m_n_all <- lm(DR_n  ~ CF_kHz_log * HearingStatus + SRgroup * StimSNR * HearingStatus, data=dat_hf)
Anova(m_n_all, test.statistic='F')
source("C:/Users/sap245/Dropbox/Articles/DT_SpIN_NHvHI/___files2share/RFiles/Fig5_SpIN_formant.R", echo=TRUE)
rm(list = ls())
cat("\014")
restrict_cf <- function(data,minVal,maxVal){
data <- data[data$CF_kHz >= minVal,]
data <- data[data$CF_kHz <= maxVal,]
return(data)
}
restrict_sr <- function(data,minVal,maxVal){
data <- data[data$SpontRate >= minVal,]
data <- data[data$SpontRate <= maxVal,]
return(data)
}
library(lme4)
library(car)
dat_all <- read.table('../tables_for_stats/Fig8_table_fric_in_noise_DR.txt', header=TRUE)
dat_all
rm(list = ls())
cat("\014")
get_deq <- function(mdl){
var_out <- data.frame(d_eq_ttr=0, d_eq_q10=0, d_eq_thr=0)
depVars <- rownames(mdl)
ttr_ind <- match("TTR_dB", depVars)
Q10_ind <- match("Q10local", depVars)
thr_ind <- match("Threshold_dBSPL", depVars)
pVal_ttr= mdl$`Pr(>F)`[ttr_ind];
df_ttr= mdl$Df.res[ttr_ind];
var_out$d_eq_ttr = 2*qt(1 - pVal_ttr, df_ttr) / sqrt(df_ttr)
pVal_q10= mdl$`Pr(>F)`[Q10_ind];
df_q10= mdl$Df.res[Q10_ind];
var_out$d_eq_q10 = 2*qt(1 - pVal_q10, df_q10) / sqrt(df_q10)
pVal_thr= mdl$`Pr(>F)`[thr_ind];
df_thr= mdl$Df.res[thr_ind];
var_out$d_eq_thr = 2*qt(1 - pVal_thr, df_thr) / sqrt(df_thr)
return(var_out)
}
library(lme4)
library(car)
dat <- read.table('../tables_for_stats/Fig8_table_fric_in_noise_DR.txt', header=TRUE)
dat
m2_fricIN <- lmer(RespCorrRaw ~ CF_kHz_log + StimSNR + Q10local + TTR_dB + (1|ChinID), data=dat)
stat_m2_fricIN <-Anova(m2_fricIN, test.statistic='F')
print(stat_m2_fricIN)
rm(list = ls())
cat("\014")
get_deq <- function(mdl){
var_out <- data.frame(d_eq_ttr=0, d_eq_q10=0, d_eq_thr=0)
depVars <- rownames(mdl)
ttr_ind <- match("TTR_dB", depVars)
Q10_ind <- match("Q10local", depVars)
thr_ind <- match("Threshold_dBSPL", depVars)
pVal_ttr= mdl$`Pr(>F)`[ttr_ind];
df_ttr= mdl$Df.res[ttr_ind];
var_out$d_eq_ttr = 2*qt(1 - pVal_ttr, df_ttr) / sqrt(df_ttr)
pVal_q10= mdl$`Pr(>F)`[Q10_ind];
df_q10= mdl$Df.res[Q10_ind];
var_out$d_eq_q10 = 2*qt(1 - pVal_q10, df_q10) / sqrt(df_q10)
pVal_thr= mdl$`Pr(>F)`[thr_ind];
df_thr= mdl$Df.res[thr_ind];
var_out$d_eq_thr = 2*qt(1 - pVal_thr, df_thr) / sqrt(df_thr)
return(var_out)
}
library(lme4)
library(car)
dat <- read.table('../tables_for_stats/Fig8_table_fric_in_noise_DR.txt', header=TRUE)
str(dat)
dat$ChinID <- as.factor(dat$ChinID) # Value doesn't matter
dat$UnitID <- as.factor(dat$UnitID) # Value doesn't matter
dat$RespCorrTXF <- log(atanh(abs(dat$RespCorr)))
dat$RespCorr_RawTXF <- log(1+atanh(.99*(dat$RespCorrRaw-min(dat$RespCorrRaw))/(max(dat$RespCorrRaw)-min(dat$RespCorrRaw)) ))
# dat$RespCorr_RawTXF <- atanh(dat$RespCorr)
# dat$RespCorr_RawTXF <- log(atanh(abs(dat$RespCorrRaw)))
dat$HearingStatus<- as.factor(dat$HearingStatus)
dat$SRgroup <- as.factor(dat$SpontRate > 18)
dat$StimSNR <- as.ordered(dat$StimSNR) # Value matters
dat$CF_kHz_log <- log(dat$CF_kHz)
dat$SignifCoding <- as.factor(dat$RespCorrRaw > .001)
####### Start with raw and check floor at the end
# Model #1
m4 <- lmer(RespCorrRaw  ~ CF_kHz_log + StimSNR + SRgroup*HearingStatus + (1|ChinID), data=dat)
Anova(m4, test.statistic='F')
plot(m4)
## Final
print("Final for Correlation")
m4 <- lm(RespCorr  ~ CF_kHz_log + StimSNR + SRgroup*HearingStatus, data=dat)
Anova(m4, test.statistic='F')
## Final
print("Final for DR")
mDR <- lm(DR_SNrelN  ~ CF_kHz_log + StimSNR + SRgroup*HearingStatus, data=dat)
Anova(mDR, test.statistic='F')
plot(m4)
# m4 <- lmer(RespCorr  ~ CF_kHz_log + StimSNR + SpontRate*HearingStatus + (1|ChinID), data=dat)
# Anova(m4, test.statistic='F')
# plot(m4)
# Model #2
m1_fricIN <- lmer(RespCorrRaw ~ CF_kHz_log + StimSNR + SRgroup + Threshold_dBSPL + Q10local + TTR_dB + (1|ChinID), data=dat)
Anova(m1_fricIN, test.statistic='F')
plot(m1_fricIN)
# Remove Threshold_dBSPL because lowest p-Value
m2_fricIN <- lmer(RespCorrRaw ~ CF_kHz_log + StimSNR + SRgroup + Q10local + TTR_dB + (1|ChinID), data=dat)
stat_m2_fricIN <-Anova(m2_fricIN, test.statistic='F')
print(stat_m2_fricIN)
plot(m2_fricIN)
# Remove SRgroup because lowest p-Value
m2_fricIN <- lmer(RespCorrRaw ~ CF_kHz_log + StimSNR + Q10local + TTR_dB + (1|ChinID), data=dat)
stat_m2_fricIN <-Anova(m2_fricIN, test.statistic='F')
print(stat_m2_fricIN)
## Final
print("Final for Correlation")
m4 <- lm(RespCorr  ~ CF_kHz_log + StimSNR + SRgroup*HearingStatus, data=dat)
Anova(m4, test.statistic='F')
source('C:/Users/spsat/Dropbox/Articles/DT_SpIN_NHvHI/___files2share/RFiles/FigS3_FricInNoise_DR_ana.R', echo=TRUE)
m_sn_lsr <- lm(DR_SN  ~ CF_kHz_log * HearingStatus + StimSNR * HearingStatus, data=dat_lsr)
Anova(m_sn_lsr, test.statistic='F')
dat_all$DR_SN
dat_all$DR_N
dat_all$DR_SN
m_sn_all <- lm(DR_SN  ~ CF_kHz_log * HearingStatus + SRgroup * StimSNR * HearingStatus, data=dat_hf)
Anova(m_sn_all, test.statistic='F')
m_sn_lsr <- lm(DR_SN  ~ CF_kHz_log * HearingStatus + StimSNR * HearingStatus, data=dat_lsr)
Anova(m_sn_lsr, test.statistic='F')
m_sn_hsr <- lm(DR_SN  ~ CF_kHz_log * HearingStatus + StimSNR * HearingStatus, data=dat_hsr)
Anova(m_sn_hsr, test.statistic='F')
View(dat_all)
dat_hf <- restrict_cf(dat_all, 2.5, 8)
dat_lsr <- restrict_sr(dat_hf, 0, 18)
dat_hsr <- restrict_sr(dat_hf, 18, Inf)
m_sn_all <- lm(DR_SN  ~ CF_kHz_log * HearingStatus + SRgroup * StimSNR * HearingStatus, data=dat_hf)
Anova(m_sn_all, test.statistic='F')
m_sn_lsr <- lm(DR_SN  ~ CF_kHz_log * HearingStatus + StimSNR * HearingStatus, data=dat_lsr)
Anova(m_sn_lsr, test.statistic='F')
m_sn_hsr <- lm(DR_SN  ~ CF_kHz_log * HearingStatus + StimSNR * HearingStatus, data=dat_hsr)
Anova(m_sn_hsr, test.statistic='F')
m_n_all <- lm(DR_n  ~ CF_kHz_log * HearingStatus + SRgroup * StimSNR * HearingStatus, data=dat_hf)
Anova(m_n_all, test.statistic='F')
m_n_all <- lm(DR_n  ~ CF_kHz_log * HearingStatus + SRgroup * StimSNR * HearingStatus, data=dat_hf)
Anova(m_n_all, test.statistic='F')
m_n_all <- lm(DR_N  ~ CF_kHz_log * HearingStatus + SRgroup * StimSNR * HearingStatus, data=dat_hf)
Anova(m_n_all, test.statistic='F')
m_n_lsr <- lm(DR_N  ~ CF_kHz_log * HearingStatus + StimSNR * HearingStatus, data=dat_lsr)
Anova(m_n_lsr, test.statistic='F')
m_sn_hsr <- lm(DR_N  ~ CF_kHz_log * HearingStatus + StimSNR * HearingStatus, data=dat_hsr)
Anova(m_sn_hsr, test.statistic='F')
m_n_all <- lm(DR_N  ~ CF_kHz_log * HearingStatus + SRgroup * StimSNR * HearingStatus, data=dat_hf)
Anova(m_n_all, test.statistic='F')
m_n_lsr <- lm(DR_N  ~ CF_kHz_log * HearingStatus + StimSNR * HearingStatus, data=dat_lsr)
Anova(m_n_lsr, test.statistic='F')
m_sn_hsr <- lm(DR_N  ~ CF_kHz_log * HearingStatus + StimSNR * HearingStatus, data=dat_hsr)
Anova(m_sn_hsr, test.statistic='F')
m_sn_all <- lm(DR_SN  ~ CF_kHz_log * HearingStatus + SRgroup * StimSNR * HearingStatus, data=dat_hf)
Anova(m_sn_all, test.statistic='F')
m_sn_lsr <- lm(DR_SN  ~ CF_kHz_log * HearingStatus + StimSNR * HearingStatus, data=dat_lsr)
Anova(m_sn_lsr, test.statistic='F')
m_sn_hsr <- lm(DR_SN  ~ CF_kHz_log * HearingStatus + StimSNR * HearingStatus, data=dat_hsr)
Anova(m_sn_hsr, test.statistic='F')
View(dat_lsr)
View(dat_hsr)
dat_lsr <- restrict_sr(dat_all, 0, 18)
dat_hsr <- restrict_sr(dat_all, 18, Inf)
m_sn_all <- lm(DR_SN  ~ CF_kHz_log * HearingStatus + SRgroup * StimSNR * HearingStatus, data=dat_hf)
Anova(m_sn_all, test.statistic='F')
m_sn_lsr <- lm(DR_SN  ~ CF_kHz_log * HearingStatus + StimSNR * HearingStatus, data=dat_lsr)
Anova(m_sn_lsr, test.statistic='F')
m_sn_hsr <- lm(DR_SN  ~ CF_kHz_log * HearingStatus + StimSNR * HearingStatus, data=dat_hsr)
Anova(m_sn_hsr, test.statistic='F')
m_n_all <- lm(DR_N  ~ CF_kHz_log * HearingStatus + SRgroup * StimSNR * HearingStatus, data=dat_hf)
Anova(m_n_all, test.statistic='F')
m_n_lsr <- lm(DR_N  ~ CF_kHz_log * HearingStatus + StimSNR * HearingStatus, data=dat_lsr)
Anova(m_n_lsr, test.statistic='F')
m_sn_hsr <- lm(DR_N  ~ CF_kHz_log * HearingStatus + StimSNR * HearingStatus, data=dat_hsr)
Anova(m_sn_hsr, test.statistic='F')
View(dat_lsr)
View(dat_lsr)
m_n_lsr <- lm(DR_N  ~ CF_kHz_log * HearingStatus + StimSNR * HearingStatus, data=dat_lsr)
Anova(m_n_lsr, test.statistic='F')
View(dat_lsr)
